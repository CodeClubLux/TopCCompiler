function main_Init(){var d=0;return function c(b){while(1){switch (d){case 0:svg_Init();main_random = toAsync(Math.random);main_cos = Math.cos;main_sin = Math.sin;main_sqrt = Math.sqrt;main_atan2 = Math.atan2;main_pi = Math.PI;main_abs = Math.abs;d=1;return serial((newVectorRange(0,100)).map(defer(main_generate)),c);case 1:main_appState = newAtom(new main_Game((b),10,10));return;}}}()}var main_random;var main_cos;var main_sin;var main_sqrt;var main_atan2;var main_pi;var main_abs;var main_appState;function main_Particle(f,g,h,j,k,l){this.x=f;this.y=g;this.limitX=h;this.limitY=j;this.velX=k;this.velY=l;}main_Particle.fields=newVector("x","y","limitX","limitY","velX","velY");function main_Game(m,n){this.particles=m;this.speed=n;}main_Game.fields=newVector("particles","speed");function main_returnId(c){return c;}function main_generate(c,d){var j;var h=0;return function g(f){while(1){switch(h){case 0:h=2;return main_random(g);case 2:j = ((f)/2.0);h=3;return main_random(g);case 3:h=4;return main_random(g);case 4:return d(new main_Particle((800.0*f),(500.0*f),800.0,500.0,j,(0.5-j),(0.5-j)));}}}()}main_Particle.prototype.toString=(function(){return main_Particle_toString(this)});function main_Particle_toString(c){return (((((((((((((((((((((((("Particle(")+(((c).x)).toString()))+(", ").toString()))+(((c).y)).toString()))+(", ").toString()))+(((c).limitX)).toString()))+(", ").toString()))+(((c).limitY)).toString()))+(", ").toString()))+(((c).velX)).toString()))+(", ").toString()))+(((c).velY)).toString()))+(")").toString());}function main_particle(c, d){return (function(){if(((c).x>((c).limitX-20.0))){return new main_Particle(((c).limitX-21.0),(c).y,(c).limitX,(c).limitY,(-(c).velX),(c).velY,(c).velY);}else if(((c).x<0.0)){return new main_Particle(4.0,(c).y,(c).limitX,(c).limitY,(-(c).velX),(c).velY,(c).velY);}else if(((c).y>((c).limitY-20.0))){return new main_Particle((c).x,((c).limitY-21.0),(c).limitX,(c).limitY,(c).velX,((-(c).velY)+0.2),((-(c).velY)+0.2));}else if(((c).y<0.0)){return new main_Particle((c).x,4.0,(c).limitX,(c).limitY,(c).velX,((-(c).velY)+0.2),((-(c).velY)+0.2));}
else{return new main_Particle(((c).x+((toFloat(d))*(c).velX)),((c).y+((toFloat(d))*(c).velY)),(c).limitX,(c).limitY,(c).velX,(c).velY,(c).velY);}})();}function main_setX(c, d){return new main_Particle((c).x,(c).y,(c).limitX,(c).limitY,d,(c).velY,(c).velY);}function main_setY(c, d){return new main_Particle((c).x,(c).y,(c).limitX,(c).limitY,(c).velX,d,d);}function main_collision(c){var d;d = c;var f;f = (c).length;var g;g = 0;
while((g<f)){var h;h = ((g+1)|0);
while((h<f)){var j;j = d.get(g);var k;k = d.get(h);var l;l = main_abs(((j).x-(k).x));var m;m = main_abs(((j).y-(k).y));var n;n = main_sqrt(((l*l)+(m*m)));if((n<30.0)){var p;p = main_manageBounce(j,k);d=(d).set(g,p.get(0));d=(d).set(h,p.get(1));;}h=((h+1)|0);}g=((g+1)|0);}return d;}function main_gameLoop(c, d,f){var k;var j=0;return function h(g){while(1){switch(j){case 0:k = (((c).particles).map((function(m){return function(l){return main_particle(l,m);}})(d)));return f(new main_Game((main_collision(k)),(c).speed,(c).speed));}}}()}function main_render(c){return svg_image(newVector(svg_href("http://vignette2.wikia.nocookie.net/chemistry/images/d/d1/500px-Water_molecule.svg.png/revision/latest?cb=200100320204351"),svg_width("20"),svg_height("20"),svg_x(((c).x).toString()),svg_y(((c).y).toString())));}function main_manageBounce(c, d){var f;f = ((c).x-(d).x);var g;g = ((c).y-(d).y);var h;h = (main_atan2(g,f));var j;j = (main_sqrt((((c).velX*(c).velX)+((c).velY*(c).velY))));var k;k = (main_sqrt((((d).velX*(d).velX)+((d).velY*(d).velY))));var l;l = (main_atan2((c).velY,(c).velX));var m;m = (main_atan2((d).velY,(d).velX));var n;n = (j*(main_cos((l-h))));var p;p = (j*(main_sin((l-h))));var q;q = (k*(main_cos((m-h))));var r;r = (k*(main_sin((m-h))));var s;s = ((((((1.0-1.0))*n)+(((1.0+1.0))*q)))/((1.0+1.0)));var t;t = ((((((1.0+1.0))*n)+(((1.0-1.0))*q)))/((1.0+1.0)));var v;v = p;var w;w = r;var x;x = (((main_cos(h))*s)+((main_cos((h+(main_pi/2.0))))*v));var y;y = (((main_sin(h))*s)+((main_sin((h+(main_pi/2.0))))*v));var z;z = (((main_cos(h))*t)+((main_cos((h+(main_pi/2.0))))*w));var B;B = (((main_sin(h))*t)+((main_sin((h+(main_pi/2.0))))*w));var C;C = (function(){if((((c).y>0.0)&&((c).y<(d).y))){return ((c).y-0.25);}
else{return (c).y;}})();var D;D = (function(){if((((d).y>0.0)&&((c).y>(d).y))){return ((d).y-0.25);}
else{return (d).y;}})();return newVector(new main_Particle((c).x,C,(c).limitX,(c).limitY,x,y,y),new main_Particle((d).x,D,(d).limitX,(d).limitY,z,B,B));}function main_changeNumber(c, d,f){var k;var l;var m;var j=0;return function h(g){while(1){switch(j){case 0:k = toInt(((d).target).value);l = ((c).particles).length;m = (1.0/(toFloat(((11-k)|0))));function n(p,q){var v;var t=0;return function s(r){while(1){switch(t){case 0:t=5;return main_generate(p,s);case 5:v = r;return q(main_adjust(m,v));}}}()}if((k>l)){j=7;return serial((newVectorRange(0,((k-l)|0))).map(defer(n)),h);}j=8;break;case 7:g=new main_Game((c).particles.operator_add((g)),(c).speed,(c).speed);j=6;/*block*/break;/*if*/case 8:/*notif*/{g=new main_Game((((c).particles).shorten(((l-k)|0))),(c).speed,(c).speed);};j=6;/*block*/break;case 6:return f(g);}}}()}function main_adjust(c, d){var f;f = ((d).velX*c);var g;g = ((d).velY*c);return main_setY((main_setX(d,f)),g);}function main_changeSpeed(c, d,f){var k;var l;var m;var n;var j=0;return function h(g){while(1){switch(j){case 0:k = toInt(((d).target).value);l = (1.0/(toFloat(((11-k)|0))));m = (1.0/(toFloat(((11-(c).speed)|0))));n = (l/m);return f(new main_Game(((c).particles).map(main_adjust.bind(null,n)),k,k));}}}()}function main_game(c, d){return html_div(html_noAttrib,newVector(html_h1(html_noAttrib,"States of matter simulations, by Lucas Goetz"),html_h3(html_noAttrib,(((("")+((((c).particles).length)).toString()))+(" Particles").toString())),html_input(newVector((html__type("range")),(html_height("10")),(html_width("100")),(html_min(0)),(html_max(200)),html_onInput(main_changeNumber,d)),""),html_h3(html_noAttrib,(((("")+(((((((c).speed*10)|0)+4)|0))).toString()))+(" Degrees Celsius").toString())),html_input(newVector((html__type("range")),(html_height("10")),(html_width("100")),(html_min(1)),(html_max(10)),(html_value((((("")+(((c).speed)).toString()))+("").toString()))),html_onInput(main_changeSpeed,d)),""),svg__svg(newVector((svg_width("100%")),svg_height("100%")),newVector(svg_rect(newVector((svg_width("800")),(svg_height("500")),(svg_fill("rgba(0,0,0,0.0)")),svg_stroke("black"))),((c).particles).map(main_render)))));}